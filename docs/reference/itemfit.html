<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Item fit statistics — itemfit • mirt</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Item fit statistics — itemfit"><meta property="og:description" content="Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise itemGAM can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., itemtype = 'spline').
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing use_dentype_estimate = TRUE will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.40</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/philchalmers/mirt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Item fit statistics</h1>
    <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/HEAD/R/itemfit.R" class="external-link"><code>R/itemfit.R</code></a></small>
    <div class="hidden name"><code>itemfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise <code><a href="itemGAM.html">itemGAM</a></code> can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., <code>itemtype = 'spline'</code>).
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing <code>use_dentype_estimate = TRUE</code> will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">itemfit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  fit_stats <span class="op">=</span> <span class="st">"S_X2"</span>,</span>
<span>  which.items <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="extract.mirt.html">extract.mirt</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"nitems"</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p.adjust <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  group.bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  group.size <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  group.fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  mincell <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mincell.X2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  return.tables <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pv_draws <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  boot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  boot_dfapprox <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  S_X2.plot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  S_X2.plot_raw.score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ETrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  ETpoints <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  empirical.plot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  empirical.CI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  empirical.poly.collapse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"EAP"</span>,</span>
<span>  Theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"#9ECAE1"</span><span class="op">)</span>, strip.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span></span>
<span>    <span class="st">"black"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">"right"</span>, points <span class="op">=</span> <span class="cn">FALSE</span>, lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a computed model object of class <code>SingleGroupClass</code>,
<code>MultipleGroupClass</code>, or <code>DiscreteClass</code></p></dd>


<dt>fit_stats</dt>
<dd><p>a character vector indicating which fit statistics should be computed.
  Supported inputs are:</p>
<ul><li><p><code>'S_X2'</code> : Orlando and Thissen (2000, 2003) and
    Kang and Chen's (2007) signed chi-squared test (default)</p></li>
<li><p><code>'Zh'</code> : Drasgow, Levine, &amp; Williams (1985) Zh</p></li>
<li><p><code>'X2'</code> : Bock's (1972) chi-squared method.
    The default inputs compute Yen's (1981) Q1 variant of the X2 statistic
    (i.e., uses a fixed <code>group.bins = 10</code>). However, Bock's group-size variable
    median-based method can be computed by passing <code>group.fun = median</code> and
    modifying the <code>group.size</code> input to the desired number of bins</p></li>
<li><p><code>'G2'</code> : McKinley &amp; Mills (1985) G2 statistic (similar method to Q1,
    but with the likelihood-ratio test).</p></li>
<li><p><code>'PV_Q1'</code> : Chalmers and Ng's (2017) plausible-value variant
    of the Q1 statistic.</p></li>
<li><p><code>'PV_Q1*'</code> : Chalmers and Ng's (2017) plausible-value variant
    of the Q1 statistic that uses parametric bootstrapping to obtain a suitable empirical
    distribution.</p></li>
<li><p><code>'X2*'</code> : Stone's (2000) fit statistics that require parametric
    bootstrapping</p></li>
<li><p><code>'X2*_df'</code> : Stone's (2000) fit statistics that require parametric
    bootstrapping to obtain scaled versions of the X2* and degrees of freedom</p></li>
<li><p><code>'infit'</code> : Compute the infit and outfit statistics</p></li>
</ul><p>Note that 'S_X2' and 'Zh' cannot be computed when there are missing response data
(i.e., will require multiple-imputation/row-removal techniques).</p></dd>


<dt>which.items</dt>
<dd><p>an integer vector indicating which items to test for fit.
Default tests all possible items</p></dd>


<dt>na.rm</dt>
<dd><p>logical; remove rows with any missing values? This is required for methods such
as S-X2 because they require the "EAPsum" method from <code><a href="fscores.html">fscores</a></code></p></dd>


<dt>p.adjust</dt>
<dd><p>method to use for adjusting all p-values for each respective item fit
statistic (see <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code> for available options). Default is <code>'none'</code></p></dd>


<dt>group.bins</dt>
<dd><p>the number of bins to use for X2 and G2. For example,
setting <code>group.bins = 10</code> will will compute Yen's (1981) Q1 statistic when <code>'X2'</code> is
requested</p></dd>


<dt>group.size</dt>
<dd><p>approximate size of each group to be used in calculating the \(\chi^2\)
statistic. The default <code>NA</code>
disables this command and instead uses the <code>group.bins</code> input to try and construct
equally sized bins</p></dd>


<dt>group.fun</dt>
<dd><p>function used when <code>'X2'</code> or <code>'G2'</code> are computed. Determines the central
tendency measure within each partitioned group. E.g., setting <code>group.fun = median</code> will
obtain the median of each respective ability estimate in each subgroup (this is what was used
by Bock, 1972)</p></dd>


<dt>mincell</dt>
<dd><p>the minimum expected cell size to be used in the S-X2 computations. Tables will be
collapsed across items first if polytomous, and then across scores if necessary</p></dd>


<dt>mincell.X2</dt>
<dd><p>the minimum expected cell size to be used in the X2 computations. Tables will be
collapsed if polytomous, however if this condition can not be met then the group block will
be omitted in the computations</p></dd>


<dt>return.tables</dt>
<dd><p>logical; return tables when investigating <code>'X2'</code>, <code>'S_X2'</code>,
and <code>'X2*'</code>?</p></dd>


<dt>pv_draws</dt>
<dd><p>number of plausible-value draws to obtain for PV_Q1 and PV_Q1*</p></dd>


<dt>boot</dt>
<dd><p>number of parametric bootstrap samples to create for PV_Q1* and X2*</p></dd>


<dt>boot_dfapprox</dt>
<dd><p>number of parametric bootstrap samples to create for the X2*_df statistic
to approximate the scaling factor for X2* as well as the scaled degrees of freedom estimates</p></dd>


<dt>S_X2.plot</dt>
<dd><p>argument input is the same as <code>empirical.plot</code>, however the resulting image
is constructed according to the S-X2 statistic's conditional sum-score information</p></dd>


<dt>S_X2.plot_raw.score</dt>
<dd><p>logical; use the raw-score information in the plot in stead of the latent
trait scale score? Default is <code>FALSE</code></p></dd>


<dt>ETrange</dt>
<dd><p>rangone of integration nodes for Stone's X2* statistic</p></dd>


<dt>ETpoints</dt>
<dd><p>number of integration nodes to use for Stone's X2* statistic</p></dd>


<dt>empirical.plot</dt>
<dd><p>a single numeric value or character of the item name indicating which
item to plot (via <code>itemplot</code>) and overlay with the empirical \(\theta\) groupings (see
<code>empirical.CI</code>). Useful for plotting the expected bins based on the <code>'X2'</code> or
<code>'G2'</code> method</p></dd>


<dt>empirical.CI</dt>
<dd><p>a numeric value indicating the width of the empirical confidence interval
ranging between 0 and 1 (default of 0 plots not interval). For example, a 95<!-- % confidence -->
interval would be plotted when <code>empirical.CI = .95</code>. Only applicable to dichotomous items</p></dd>


<dt>empirical.poly.collapse</dt>
<dd><p>logical; collapse polytomous item categories to for expected scoring
functions for empirical plots? Default is <code>FALSE</code></p></dd>


<dt>method</dt>
<dd><p>type of factor score estimation method. See <code><a href="fscores.html">fscores</a></code> for more detail</p></dd>


<dt>Theta</dt>
<dd><p>a matrix of factor scores for each person used for statistics that require
empirical estimates. If supplied, arguments typically passed to <code><a href="fscores.html">fscores()</a></code> will be
ignored and these values will be used instead. Also required when estimating statistics
with missing data via imputation</p></dd>


<dt>par.strip.text</dt>
<dd><p>plotting argument passed to <code>lattice</code></p></dd>


<dt>par.settings</dt>
<dd><p>plotting argument passed to <code>lattice</code></p></dd>


<dt>auto.key</dt>
<dd><p>plotting argument passed to <code>lattice</code></p></dd>


<dt>...</dt>
<dd><p>additional arguments to be passed to <code><a href="fscores.html">fscores()</a></code> and <code>lattice</code></p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Bock, R. D. (1972). Estimating item parameters and latent ability when responses are scored
in two or more nominal categories. <em>Psychometrika, 37</em>, 29-51.</p>
<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Chalmers, R. P. &amp; Ng, V. (2017). Plausible-Value Imputation Statistics for Detecting
Item Misfit. <em>Applied Psychological Measurement, 41</em>, 372-387.
<a href="https://doi.org/10.1177/0146621617692079" class="external-link">doi:10.1177/0146621617692079</a></p>
<p>Drasgow, F., Levine, M. V., &amp; Williams, E. A. (1985). Appropriateness measurement with
polychotomous item response models and standardized indices.
<em>British Journal of Mathematical and Statistical Psychology, 38</em>, 67-86.</p>
<p>Kang, T. &amp; Chen, Troy, T. (2007). An investigation of the performance of the generalized
S-X2 item-fit index for polytomous IRT models. ACT</p>
<p>McKinley, R., &amp; Mills, C. (1985). A comparison of several goodness-of-fit statistics.
Applied Psychological Measurement, 9, 49-57.</p>
<p>Orlando, M. &amp; Thissen, D. (2000). Likelihood-based item fit indices for dichotomous item
response theory models. <em>Applied Psychological Measurement, 24</em>, 50-64.</p>
<p>Reise, S. P. (1990). A comparison of item- and person-fit methods of assessing model-data fit
in IRT. <em>Applied Psychological Measurement, 14</em>, 127-137.</p>
<p>Stone, C. A. (2000). Monte Carlo Based Null Distribution for an Alternative Goodness-of-Fit
Test Statistics in IRT Models. <em>Journal of Educational Measurement, 37</em>, 58-75.</p>
<p>Wright B. D. &amp; Masters, G. N. (1982). <em>Rating scale analysis</em>. MESA Press.</p>
<p>Yen, W. M. (1981). Using simulation results to choose a latent trait model.
<em>Applied Psychological Measurement, 5</em>, 245-262.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="personfit.html">personfit</a></code>, <code><a href="itemGAM.html">itemGAM</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#make some data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>, meanlog<span class="op">=</span><span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu">P</span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">baditem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">baditem</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">ps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>, <span class="fl">2000</span>, <span class="va">items</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span>, baditem<span class="op">=</span><span class="va">baditem</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">raschfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  16.519      15      0.007  0.348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  11.718      15      0.000  0.700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  22.835      15      0.016  0.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  11.703      16      0.000  0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  15.241      15      0.003  0.434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  11.983      16      0.000  0.745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  23.912      16      0.016  0.091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  12.744      15      0.000  0.622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  16.931      15      0.008  0.323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10   9.199      16      0.000  0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  17.630      15      0.009  0.283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  12.198      15      0.000  0.664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  17.487      15      0.009  0.291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  19.117      15      0.012  0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  11.542      16      0.000  0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  12.534      16      0.000  0.706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  29.453      15      0.022  0.014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  15.064      16      0.000  0.520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  17.125      15      0.008  0.311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  10.064      15      0.000  0.816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 233.224      18      0.077  0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># p-value adjustment</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, p.adjust<span class="op">=</span><span class="st">'fdr'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  16.519      15      0.007  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  11.718      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  22.835      15      0.016  0.480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  11.703      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  15.241      15      0.003  0.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  11.983      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  23.912      16      0.016  0.480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  12.744      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  16.931      15      0.008  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10   9.199      16      0.000  0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  17.630      15      0.009  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  12.198      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  17.487      15      0.009  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  19.117      15      0.012  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  11.542      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  12.534      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  29.453      15      0.022  0.148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  15.064      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  17.125      15      0.008  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  10.064      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 233.224      18      0.077  0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># two different fit stats (with/without p-value adjustment)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span> ,<span class="st">'X2'</span><span class="op">)</span>, p.adjust<span class="op">=</span><span class="st">'fdr'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item      X2 df.X2 RMSEA.X2  p.X2    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  30.842     8    0.038 0.000  16.519      15      0.007  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  27.970     8    0.035 0.001  11.718      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  43.995     8    0.047 0.000  22.835      15      0.016  0.480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  33.272     8    0.040 0.000  11.703      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  29.469     8    0.037 0.001  15.241      15      0.003  0.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  21.325     8    0.029 0.007  11.983      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  23.127     8    0.031 0.004  23.912      16      0.016  0.480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  25.332     8    0.033 0.002  12.744      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  33.778     8    0.040 0.000  16.931      15      0.008  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  22.972     8    0.031 0.004   9.199      16      0.000  0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  27.300     8    0.035 0.001  17.630      15      0.009  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  23.256     8    0.031 0.004  12.198      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  31.523     8    0.038 0.000  17.487      15      0.009  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  27.924     8    0.035 0.001  19.117      15      0.012  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  18.462     8    0.026 0.020  11.542      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  25.057     8    0.033 0.002  12.534      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  14.828     8    0.021 0.063  29.453      15      0.022  0.148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  17.676     8    0.025 0.025  15.064      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  32.585     8    0.039 0.000  17.125      15      0.008  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  37.207     8    0.043 0.000  10.064      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 228.367     8    0.117 0.000 233.224      18      0.077  0.000</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span> ,<span class="st">'X2'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item      X2 df.X2 RMSEA.X2  p.X2    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  30.842     8    0.038 0.000  16.519      15      0.007  0.348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  27.970     8    0.035 0.000  11.718      15      0.000  0.700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  43.995     8    0.047 0.000  22.835      15      0.016  0.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  33.272     8    0.040 0.000  11.703      16      0.000  0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  29.469     8    0.037 0.000  15.241      15      0.003  0.434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  21.325     8    0.029 0.006  11.983      16      0.000  0.745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  23.127     8    0.031 0.003  23.912      16      0.016  0.091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  25.332     8    0.033 0.001  12.744      15      0.000  0.622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  33.778     8    0.040 0.000  16.931      15      0.008  0.323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  22.972     8    0.031 0.003   9.199      16      0.000  0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  27.300     8    0.035 0.001  17.630      15      0.009  0.283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  23.256     8    0.031 0.003  12.198      15      0.000  0.664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  31.523     8    0.038 0.000  17.487      15      0.009  0.291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  27.924     8    0.035 0.000  19.117      15      0.012  0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  18.462     8    0.026 0.018  11.542      16      0.000  0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  25.057     8    0.033 0.002  12.534      16      0.000  0.706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  14.828     8    0.021 0.063  29.453      15      0.022  0.014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  17.676     8    0.025 0.024  15.064      16      0.000  0.520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  32.585     8    0.039 0.000  17.125      15      0.008  0.311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  37.207     8    0.043 0.000  10.064      15      0.000  0.816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 228.367     8    0.117 0.000 233.224      18      0.077  0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conditional sum-score plot from S-X2 information</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># good fit</span></span></span>
<span class="r-plt img"><img src="itemfit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># good fit</span></span></span>
<span class="r-plt img"><img src="itemfit-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="co"># bad fit</span></span></span>
<span class="r-plt img"><img src="itemfit-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span><span class="op">)</span> <span class="co"># just X2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item      X2 df.X2 RMSEA.X2  p.X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  30.842     8    0.038 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  27.970     8    0.035 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  43.995     8    0.047 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  33.272     8    0.040 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  29.469     8    0.037 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  21.325     8    0.029 0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  23.127     8    0.031 0.003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  25.332     8    0.033 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  33.778     8    0.040 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  22.972     8    0.031 0.003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  27.300     8    0.035 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  23.256     8    0.031 0.003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  31.523     8    0.038 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  27.924     8    0.035 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  18.462     8    0.026 0.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  25.057     8    0.033 0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  14.828     8    0.021 0.063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  17.676     8    0.025 0.024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  32.585     8    0.039 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  37.207     8    0.043 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 228.367     8    0.117 0.000</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co"># X2 with maximum-likelihood estimates for traits</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following factor score estimates failed to converge successfully:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     311,315,352,518,677,748,909,927,1081,1243,1277,1305,1415,1480,1620,1893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item      X2 df.X2 RMSEA.X2  p.X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  35.941     8    0.042 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  53.226     8    0.053 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  47.010     8    0.049 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  85.852     8    0.070 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  85.280     8    0.070 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6   8.632     8    0.006 0.374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  57.623     8    0.056 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  42.952     8    0.047 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  55.180     8    0.054 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  32.456     8    0.039 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11 131.613     8    0.088 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  50.094     8    0.051 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  55.846     8    0.055 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  18.717     8    0.026 0.016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  12.402     8    0.017 0.134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  38.229     8    0.043 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17   4.413     8    0.000 0.818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  16.165     8    0.023 0.040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  14.190     8    0.020 0.077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  21.215     8    0.029 0.007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 227.191     8    0.117 0.000</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, group.bins<span class="op">=</span><span class="fl">15</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co">#empirical item plot with 15 points</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following factor score estimates failed to converge successfully:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     311,315,352,518,677,748,909,927,1081,1243,1277,1305,1415,1480,1620,1893</span>
<span class="r-plt img"><img src="itemfit-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, group.bins<span class="op">=</span><span class="fl">15</span>, empirical.plot <span class="op">=</span> <span class="fl">21</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following factor score estimates failed to converge successfully:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     311,315,352,518,677,748,909,927,1081,1243,1277,1305,1415,1480,1620,1893</span>
<span class="r-plt img"><img src="itemfit-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PV and X2* statistics (parametric bootstrap stats not run to save time)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'PV_Q1'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item   PV_Q1 df.PV_Q1 RMSEA.PV_Q1 p.PV_Q1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1   8.984        8       0.008   0.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2   9.441        8       0.009   0.306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3   7.162        8       0.000   0.519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4   8.463        8       0.005   0.390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5   8.755        8       0.007   0.363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6   9.411        8       0.009   0.309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7   8.678        8       0.007   0.370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8   8.269        8       0.004   0.408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9   9.005        8       0.008   0.342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10   6.873        8       0.000   0.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11   9.871        8       0.011   0.274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12   9.214        8       0.009   0.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13   8.889        8       0.007   0.352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14   9.088        8       0.008   0.335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15   8.583        8       0.006   0.379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16   8.848        8       0.007   0.355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17   8.408        8       0.005   0.395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18   8.000        8       0.000   0.433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19   8.742        8       0.007   0.365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20   7.823        8       0.000   0.451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 118.597        8       0.083   0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="mirtCluster.html">mirtCluster</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># improve speed of bootstrap samples by running in parallel</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'PV_Q1*')</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'X2*') # Stone's 1993 statistic</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'X2*_df') # Stone's 2000 scaled statistic with df estimate</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># empirical tables for X2 statistic</span></span></span>
<span class="r-in"><span><span class="va">tabs</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, which.items <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tabs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -1.4531`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      183 158.63869   1.934176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       17  41.36131  -3.787943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.9416`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      149 138.43172  0.8982277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       51  61.56828 -1.3468702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.6475`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      132 124.64146  0.6591135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       68  75.35854 -0.8476670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.3921`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected  z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      112 111.77447  0.02133235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       88  88.22553 -0.02401114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.1393`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       88  98.63125  -1.070476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      112 101.36875   1.055923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.0936`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected  z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       86  86.5533 -0.05947283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      114 113.4467  0.05194748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.346`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       61  73.91477  -1.502177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      139 126.08523   1.150150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.6087`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       54  61.64828 -0.9740998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      146 138.35172  0.6502370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.9646`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       41  47.0127 -0.8769235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      159 152.9873  0.4861179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 1.5621`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       24  28.27768 -0.8044264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      176 171.72232  0.3264336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#infit/outfit statistics. method='ML' agrees better with eRm package</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'infit'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co">#infit and outfit stats</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item outfit z.outfit infit z.infit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  0.919   -2.945 0.951  -2.699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  0.962   -1.281 0.960  -2.010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  0.876   -4.455 0.918  -4.332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  0.998   -0.049 1.009   0.495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  0.982   -0.523 0.974  -1.227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  0.890   -2.233 0.950  -1.692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  1.008    0.259 1.003   0.171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  0.933   -1.743 0.961  -1.631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  0.958   -1.519 0.964  -1.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  1.011    0.303 1.013   0.534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  0.898   -2.300 0.939  -2.531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  0.988   -0.383 1.012   0.607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  0.991   -0.263 1.002   0.093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  0.973   -0.841 0.974  -1.256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  0.947   -0.943 0.993  -0.210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  0.988   -0.271 0.985  -0.546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  0.878   -1.532 0.960  -0.872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  0.961   -0.759 0.978  -0.742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  0.943   -2.060 0.974  -1.352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  0.868   -4.736 0.911  -4.687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem  1.513   16.123 1.338  16.509</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#same as above, but inputting ML estimates instead (saves time for re-use)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">raschfit</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'infit'</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item outfit z.outfit infit z.infit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  0.919   -2.945 0.951  -2.699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  0.962   -1.281 0.960  -2.010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  0.876   -4.455 0.918  -4.332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  0.998   -0.049 1.009   0.495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  0.982   -0.523 0.974  -1.227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  0.890   -2.233 0.950  -1.692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  1.008    0.259 1.003   0.171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  0.933   -1.743 0.961  -1.631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  0.958   -1.519 0.964  -1.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  1.011    0.303 1.013   0.534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  0.898   -2.300 0.939  -2.531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  0.988   -0.383 1.012   0.607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  0.991   -0.263 1.002   0.093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  0.973   -0.841 0.974  -1.256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  0.947   -0.943 0.993  -0.210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  0.988   -0.271 0.985  -0.546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  0.878   -1.532 0.960  -0.872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  0.961   -0.759 0.978  -0.742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  0.943   -2.060 0.974  -1.352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  0.868   -4.736 0.911  -4.687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem  1.513   16.123 1.338  16.509</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, empirical.plot<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="itemfit-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, Theta<span class="op">=</span><span class="va">Theta</span>, which.items<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -1.7718`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      177 166.44926  0.8177906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       23  33.55074 -1.8215117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -1.0782`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      150 142.51602  0.6269036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       50  57.48398 -0.9870955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.7497`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      132 128.19072  0.3364454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       68  71.80928 -0.4495237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.4577`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0      118 114.2782  0.3481537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       82  85.7218 -0.4019824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.193`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       86 101.13957  -1.505404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      114  98.86043   1.522658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.0765`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       75  87.7275  -1.358862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      125 112.2725   1.201175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.3374`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       72  75.15333 -0.3637435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      128 124.84667  0.2822155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.6728`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       54  60.18187 -0.7968690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      146 139.81813  0.5228029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 1.0787`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected  z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       44  44.57924 -0.08675380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      156 155.42076  0.04646226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 1.9249`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected   z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       22  21.91506  0.018144153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1      178 178.08494 -0.006364942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a new more flexible model for the mis-fitting item</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">20</span><span class="op">)</span>, <span class="st">'spline'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> EM cycles terminated after 500 iterations.</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1 13.109      15      0.000  0.594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2 13.513      15      0.000  0.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3 21.887      15      0.015  0.111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  9.894      15      0.000  0.826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5 16.248      15      0.006  0.366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6 10.218      16      0.000  0.855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7 18.279      15      0.010  0.248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 13.587      16      0.000  0.629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9 13.485      15      0.000  0.565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 10.569      16      0.000  0.835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11 16.325      15      0.007  0.361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  9.663      15      0.000  0.840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13 19.394      16      0.010  0.249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14 16.357      15      0.007  0.359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  9.410      16      0.000  0.896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16 13.578      16      0.000  0.630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17 29.945      16      0.021  0.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18 15.058      16      0.000  0.520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19 15.663      15      0.005  0.405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  9.333      15      0.000  0.859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 11.473      13      0.000  0.571</span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">x2</span>, <span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="itemfit-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         AIC    SABIC       HQ      BIC    logLik     X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  49477.85 49579.65 49564.23 49713.09 -24696.93            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2 49214.97 49321.62 49305.46 49461.41 -24563.49 266.88  2 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#similar example to Kang and Chen 2007</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>,<span class="fl">.4</span>,<span class="fl">.7</span>, <span class="fl">.8</span>, <span class="fl">.4</span>, <span class="fl">.7</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.0</span>,<span class="fl">0.0</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>, itemtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'graded'</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]      4      0      1      4      1      4      3      2      1       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      2      1      1      3      2      4      2      1      4       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]      2      2      3      0      0      0      4      4      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]      1      2      4      1      2      2      2      2      0       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]      1      3      0      2      1      4      4      4      3       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]      1      3      3      2      3      1      1      2      0       1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1 143.021     103      0.014  0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  85.589     109      0.000  0.953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3 110.835     105      0.005  0.330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4 121.145     103      0.009  0.107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5 107.875     111      0.000  0.566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  93.905     102      0.000  0.704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7 113.544      99      0.009  0.151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 100.858      99      0.003  0.429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  83.214      98      0.000  0.857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 104.402      99      0.005  0.336</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'X2'</span><span class="op">)</span> <span class="co"># less useful given inflated Type I error rates</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item      X2 df.X2 RMSEA.X2  p.X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  93.925    35    0.029 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  43.667    35    0.011 0.149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  81.354    35    0.026 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  90.490    35    0.028 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  36.169    35    0.004 0.414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  97.559    35    0.030 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7 129.917    35    0.037 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 130.263    35    0.037 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9 141.266    35    0.039 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 117.650    35    0.034 0.000</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="itemfit-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span>, empirical.poly.collapse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="itemfit-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># collapsed tables (see mincell.X2) for X2 and G2</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'X2'</span>, return.tables <span class="op">=</span> <span class="cn">TRUE</span>, which.items <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -1.4692`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       98 65.020718  4.0899247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       76 88.468143 -1.3255872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       12 26.774054 -2.8552400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3        7  6.656543  0.1331215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4        7 13.080542 -1.6812388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.8519`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       65 45.508938  2.8892636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       87 88.222767 -0.1301827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       29 35.896766 -1.1511126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3        6  9.834511 -1.2227385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       13 20.537019 -1.6631481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.5476`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       35 37.54994 -0.4161270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       97 85.03642  1.2973549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       34 40.25662 -0.9861003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3        5 11.70198 -1.9591763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       29 25.45504  0.7026267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.3145`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       27 32.21053 -0.9180857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       91 81.40120  1.0639013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       40 43.28252 -0.4989437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       15 13.23174  0.4861130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       27 29.87400 -0.5258232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.0993`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       23 27.84181 -0.9176111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       73 77.27754 -0.4865943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       60 45.69537  2.1161218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       12 14.68759 -0.7012737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       32 34.49770 -0.4252515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.1116`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected  z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       23 24.05321 -0.21474860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       73 72.66989  0.03872444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       50 47.59720  0.34827910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       16 16.11821 -0.02944308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       38 39.56149 -0.24825845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.3293`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected   z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       18 20.61824 -0.576612407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       69 67.48888  0.183942450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       49 48.98546  0.002077898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       24 17.55297  1.538809131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       40 45.35445 -0.795069543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.5568`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected  z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0        6 17.49926 -2.74890777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       60 61.79242 -0.22801909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       56 49.73600  0.88821096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       19 18.94936  0.01163316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       59 52.02296  0.96732827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.8512`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0        7 14.09896 -1.8906068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       45 54.28449 -1.2601441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       48 49.58044 -0.2244513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       26 20.49440  1.2161493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       74 61.54171  1.5880848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 1.4358`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0        6  9.087564 -1.0242177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       25 40.094053 -2.3837784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       44 45.694100 -0.2506161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       21 22.208083 -0.2563547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4      104 82.916200  2.3154168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod2</span>, <span class="st">'infit'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item outfit z.outfit infit z.infit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  0.959   -1.405 0.946  -2.139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  1.098    3.228 1.074   2.794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  0.962   -1.324 0.961  -1.572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  0.946   -1.865 0.932  -2.702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  1.121    3.945 1.094   3.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  0.917   -2.900 0.917  -3.294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  0.864   -4.827 0.881  -4.897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  0.873   -4.654 0.880  -5.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  0.876   -4.465 0.887  -4.694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  0.883   -4.253 0.892  -4.517</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># massive list of tables for S-X2</span></span></span>
<span class="r-in"><span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, return.tables <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#observed and expected total score patterns for item 1 (post collapsing)</span></span></span>
<span class="r-in"><span><span class="va">tables</span><span class="op">$</span><span class="va">O</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  1  2  3  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  12  3  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8 17  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  12 16  5  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  22  8  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  30 20  3  3  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 19 27  9  1  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 16 32  9  4  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 17 40 17  1  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 25 51 15  4  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 22 44 14  3  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 22 46 22  5 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 14 41 32  8 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 11 42 31  8 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 11 57 25  7 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 17 41 37 11 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 11 35 28 12 26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 10 32 32  8 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  5 32 18 15 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  2 23 17  7 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  2 30 22  9 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  3 15 19  7 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  3 12 16 11 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  4 13 12  4 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  3  6  9  5 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  3  6  2 17  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  3 10  2 21  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  1  2  1 13  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  1  4  5  6  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  3  4  4  5  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  1  3  1 11  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  2  6  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  2  6  0  0  0</span>
<span class="r-in"><span><span class="va">tables</span><span class="op">$</span><span class="va">E</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]      [,3]      [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 11.023325  3.976675        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.102366  2.897634        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 13.498246 10.610902  1.890852        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 15.184304 14.492730  3.322965        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 12.249443 13.799872  3.950685        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 20.682046 26.920288  6.923239  1.157706  1.316720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 20.332439 30.097150  8.830861  1.641385  2.098165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 17.517441 29.135716  9.625822  1.958940  2.762080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 20.446921 37.829468 13.940499  3.072836  4.710276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 23.437800 47.811327 19.504466  4.622495  7.623912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 18.436615 41.167389 18.467918  4.679944  8.248134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 19.651227 47.756678 23.431406  6.318731 11.841957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 19.076413 50.199010 26.830125  7.670547 15.223905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 14.528071 41.195659 23.904020  7.227464 15.144786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 15.799085 48.086720 30.192468  9.636968 21.284760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 13.544069 44.116503 29.895563 10.055666 23.388198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 11.078348 38.500292 28.110440  9.952500 24.358420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  9.068050 33.529616 26.330542  9.809752 25.262041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  7.581094 29.780090 25.109651  9.840833 26.688332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  5.489874 22.880802 20.702905  8.532437 24.393982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  5.010515 22.116677 21.467501  9.311108 28.094199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  3.626463 16.954931 17.637672  8.059013 25.721921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  2.805419 13.907880 15.517623  7.472196 25.296882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]  1.907017 10.013898 12.004816  6.104317 21.969952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]  1.261885  7.039995  9.063539  4.881523 18.753058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]  4.944641  5.875443  3.354204 13.825711        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]  5.454637  7.095249  4.313860 19.136254        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]  2.176787  3.093386  2.019117  9.710709        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]  1.685470  2.659415  1.858932  9.796184        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]  1.334541  2.384692  1.813140 10.467628        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]  1.040082  2.042086  1.733955 11.183876        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,]  2.050562  5.949438        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,]  1.369048  6.630952        NA        NA        NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># can also select specific items</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(mod, return.tables = TRUE, which.items=1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit stats with missing data (run in parallel using all cores)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">raschfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use only valid data by removing rows with missing terms</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span>, <span class="st">'infit'</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sample size after row-wise response data removal: 1901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item outfit z.outfit infit z.infit    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  0.906   -3.624 0.911  -3.657 155.059     102      0.017  0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  0.997   -0.104 1.004   0.148 146.677     103      0.015  0.003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  0.917   -3.280 0.919  -3.383 114.788     103      0.008  0.201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  0.884   -4.446 0.896  -4.289 121.469     102      0.010  0.092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  1.006    0.238 1.009   0.351 204.476     103      0.023  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  0.880   -4.513 0.895  -4.214  93.808     103      0.000  0.730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  0.852   -5.850 0.866  -5.665 129.870     102      0.012  0.033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  0.862   -5.634 0.870  -5.605 120.874     102      0.010  0.098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  0.855   -5.839 0.867  -5.720  96.806     102      0.000  0.627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10  0.852   -6.125 0.863  -6.017 111.849     101      0.008  0.216</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note that X2, G2, PV-Q1, and X2* do not require complete datasets</span></span></span>
<span class="r-in"><span><span class="va">thetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">raschfit</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co"># save for faster computations</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X2'</span>, <span class="st">'G2'</span><span class="op">)</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item     X2 df.X2 RMSEA.X2  p.X2     G2 df.G2 RMSEA.G2  p.G2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1 53.134    36    0.015 0.033 56.307    36    0.017 0.017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2 70.263    36    0.022 0.001 65.934    36    0.020 0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3 52.499    36    0.015 0.037 53.680    36    0.016 0.029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4 42.911    36    0.010 0.199 42.436    36    0.009 0.213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5 99.602    36    0.030 0.000 83.221    36    0.026 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6 30.799    36    0.000 0.714 32.378    36    0.000 0.642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7 61.453    36    0.019 0.005 66.355    35    0.021 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 58.196    36    0.018 0.011 60.014    36    0.018 0.007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9 55.505    36    0.016 0.020 58.956    35    0.019 0.007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 45.083    36    0.011 0.143 48.696    36    0.013 0.077</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, empirical.plot<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="itemfit-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, which.items<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.9751`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       99 89.201156  1.0375036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       81 87.321894 -0.6765278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       12 20.552377 -1.8864956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3        5  2.584801  1.5022397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4        5  2.339772  1.7391302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.4747`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       50 55.807829 -0.7774389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       96 90.114011  0.6200451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       36 34.984506  0.1716879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3        5  7.257473 -0.8379725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       12 10.836181  0.3535470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.2825`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected   z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       44 43.95125  0.007353318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       96 86.00540  1.077711616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       32 40.46378 -1.330549586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3        9 10.17263 -0.367659295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       18 18.40694 -0.094849986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.151`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       33 36.30130 -0.5479285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       75 81.02246 -0.6690693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       45 43.47853  0.2307410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       13 12.46725  0.1508827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       33 25.73046  1.4331223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = -0.0334`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       20 29.92973 -1.8150395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       86 75.13704  1.2532020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       54 45.35149  1.2842374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       10 14.62700 -1.2098237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       29 33.95473 -0.8502955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.0651`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       23 25.01780 -0.4034162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       67 69.30612 -0.2770101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       58 46.16154  1.7424292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       17 16.42915  0.1408350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       34 42.08539 -1.2463366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.1643`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       19 20.52730 -0.3371007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       69 62.79441  0.7831101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       43 46.18450 -0.4685899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       26 18.15088  1.8423492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       42 51.34291 -1.3038926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.2768`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0        4 16.04376 -3.0068309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       58 54.92441  0.4149982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       49 45.20754  0.5640478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       19 19.88303 -0.1980314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       69 62.94127  0.7636847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.4165`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed Expected    z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0       10 11.43162 -0.4234219850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       45 45.00349 -0.0005202907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       50 42.59621  1.1344070685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       22 21.54378  0.0982913278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4       72 78.42491 -0.7255041635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`theta = 0.7405`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Observed  Expected z.Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_0        4   4.63062 -0.2930545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_1       23  25.20562 -0.4393217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_2       42  32.98693  1.5692840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_3       24  23.06815  0.1940175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat_4      109 116.10867 -0.6597149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

