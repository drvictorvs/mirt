<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a user defined item with correct generic functions — createItem • mirt</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create a user defined item with correct generic functions — createItem"><meta property="og:description" content="Initializes the proper S4 class and methods necessary for mirt
functions to use in estimation. To use the defined objects pass to the
mirt(..., customItems = list()) command, and
ensure that the classes are properly labeled and unique in the list.
Additionally, the input mirt(..., customItemsData = list()) can
also be included to specify additional item-level information to better
recycle custom-item definitions (e.g., for supplying varying
Q-matrices), where the list input must have the same length as the
number of items. For further examples regarding how this function can be
used for fitting unfolding-type models see Liu and Chalmers (2018)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.40</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/philchalmers/mirt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a user defined item with correct generic functions</h1>
    <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/HEAD/R/createItem.R" class="external-link"><code>R/createItem.R</code></a></small>
    <div class="hidden name"><code>createItem.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Initializes the proper S4 class and methods necessary for <code><a href="mirt.html">mirt</a></code>
functions to use in estimation. To use the defined objects pass to the
<code>mirt(..., customItems = list())</code> command, and
ensure that the classes are properly labeled and unique in the list.
Additionally, the input <code>mirt(..., customItemsData = list())</code> can
also be included to specify additional item-level information to better
recycle custom-item definitions (e.g., for supplying varying
Q-matrices), where the <code>list</code> input must have the same length as the
number of items. For further examples regarding how this function can be
used for fitting unfolding-type models see Liu and Chalmers (2018).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">createItem</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">par</span>,</span>
<span>  <span class="va">est</span>,</span>
<span>  <span class="va">P</span>,</span>
<span>  gr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hss <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lbound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ubound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  derivType <span class="op">=</span> <span class="st">"Richardson"</span>,</span>
<span>  derivType.hss <span class="op">=</span> <span class="st">"Richardson"</span>,</span>
<span>  bytecompile <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>name</dt>
<dd><p>a character indicating the item class name to be defined</p></dd>


<dt>par</dt>
<dd><p>a named vector of the starting values for the parameters</p></dd>


<dt>est</dt>
<dd><p>a logical vector indicating which parameters should be freely estimated by default</p></dd>


<dt>P</dt>
<dd><p>the probability trace function for all categories (first column is category 1, second
  category two, etc). First input contains a vector of all the item parameters, the second input
  must be a matrix called <code>Theta</code>, the third input must be the number of categories
  called <code>ncat</code>, and (optionally) a fourth argument termed <code>itemdata</code>
  may be included containing further  users specification information.
  The last optional input is to be utilized within the estimation functions
  such as <code><a href="mirt.html">mirt</a></code> via the list input <code>customItemsData</code>
  to more naturally recycle custom-item definitions. Therefore, these inputs must be of the form</p>
<p><code>function(par, Theta, ncat){...}</code></p>
<p>or</p>
<p><code>function(par, Theta, ncat, itemdata){...}</code></p>
<p>to be valid; however, the names of the arguements is not relavent.</p>
<p>Finally, this function must return a <code>matrix</code> object of category probabilities, where
  the columns represent each respective category</p></dd>


<dt>gr</dt>
<dd><p>gradient function (vector of first derivatives) of the log-likelihood used in
estimation. The function must be of the form <code>gr(x, Theta)</code>, where <code>x</code> is the object
defined by <code>createItem()</code> and <code>Theta</code> is a matrix of latent trait parameters.
Tabulated (EM) or raw (MHRM) data are located in the <code>x@dat</code> slot, and are used to form
the complete data log-likelihood. If not specified a numeric approximation will be used</p></dd>


<dt>hss</dt>
<dd><p>Hessian function (matrix of second derivatives) of the log-likelihood used in
estimation. If not specified a numeric approximation will be used (required for the MH-RM
algorithm only). The input is identical to the <code>gr</code> argument</p></dd>


<dt>gen</dt>
<dd><p>a function used when <code>GenRandomPars = TRUE</code> is passed to the estimation function
to generate random starting values. Function must be of the form <code>function(object) ...</code>
and must return a vector with properties equivalent to the <code>par</code> object. If NULL,
parameters will remain at the defined starting values by default</p></dd>


<dt>lbound</dt>
<dd><p>optional vector indicating the lower bounds of the parameters. If not specified
then the bounds will be set to -Inf</p></dd>


<dt>ubound</dt>
<dd><p>optional vector indicating the lower bounds of the parameters. If not specified
then the bounds will be set to Inf</p></dd>


<dt>derivType</dt>
<dd><p>if the <code>gr</code> term is not specified this type will be used to
obtain the gradient numerically or symbolically. Default is the 'Richardson'
extrapolation method; see <code><a href="numerical_deriv.html">numerical_deriv</a></code> for details and other options. If
<code>'symbolic'</code> is supplied then the gradient will be computed using
a symbolical approach (potentially the most accurate method, though may fail depending
on how the <code>P</code> function was defined)</p></dd>


<dt>derivType.hss</dt>
<dd><p>if the <code>hss</code> term is not specified this type will be used to
obtain the Hessian numerically. Default is the 'Richardson'
extrapolation method; see <code><a href="numerical_deriv.html">numerical_deriv</a></code> for details and other options. If
<code>'symbolic'</code> is supplied then the Hessian will be computed using
a symbolical approach (potentially the most accurate method, though may fail depending
on how the <code>P</code> function was defined)</p></dd>


<dt>bytecompile</dt>
<dd><p>logical; where applicable, byte compile the functions provided? Default is
<code>TRUE</code> to provide</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function will not return proper standardized loadings
since the function is not sure how to handle them (no slopes could be
defined at all!). Instead loadings of .001 are filled in as place-holders.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Liu, C.-W. and Chalmers, R. P. (2018). Fitting item response unfolding models to
  Likert-scale data using mirt in R. <em>PLoS ONE, 13</em>, 5.
  <a href="https://doi.org/10.1371/journal.pone.0196292" class="external-link">doi:10.1371/journal.pone.0196292</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">'old2PL'</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">.5</span>, b <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P.old2PL</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>,<span class="va">Theta</span>, <span class="va">ncat</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">P1</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">a</span><span class="op">*</span><span class="op">(</span><span class="va">Theta</span> <span class="op">-</span> <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">P1</span>, <span class="va">P1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">createItem</span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">P.old2PL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># So, let's estimate it!</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="expand.table.html">expand.table</a></span><span class="op">(</span><span class="va">LSAT7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">4</span><span class="op">)</span>, <span class="st">'old2PL'</span><span class="op">)</span>, customItems<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>old2PL<span class="op">=</span><span class="va">x</span><span class="op">)</span>, pars <span class="op">=</span> <span class="st">'values'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">sv</span><span class="op">)</span> <span class="co">#looks good</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    group   item     class   name parnum value lbound ubound   est prior.type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   all Item.4      dich      g     15   0.0  0e+00      1 FALSE       none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   all Item.4      dich      u     16   1.0  0e+00      1 FALSE       none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   all Item.5    custom      a     17   0.5   -Inf    Inf  TRUE       none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   all Item.5    custom      b     18  -2.0   -Inf    Inf  TRUE       none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   all  GROUP GroupPars MEAN_1     19   0.0   -Inf    Inf FALSE       none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   all  GROUP GroupPars COV_11     20   1.0  1e-04    Inf FALSE       none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    prior_1 prior_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     NaN     NaN</span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">4</span><span class="op">)</span>, <span class="st">'old2PL'</span><span class="op">)</span>, customItems<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>old2PL<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.989 1.856 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.081 0.808 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.703 1.803 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.766 0.486 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a      b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.737 -2.518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">4</span><span class="op">)</span>, <span class="st">'old2PL'</span><span class="op">)</span>, customItems<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>old2PL<span class="op">=</span><span class="va">x</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">'MHRM'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.965 1.842 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.093 0.809 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.747 1.822 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.779 0.487 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a      b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.752 -2.474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same definition as above, but using symbolic derivative computations</span></span></span>
<span class="r-in"><span><span class="co"># (can be more accurate/stable)</span></span></span>
<span class="r-in"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu">createItem</span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">P.old2PL</span>, derivType <span class="op">=</span> <span class="st">'symbolic'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Called from: createItem(name, par = par, est = est, P = P.old2PL, derivType = "symbolic")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: tmppars &lt;- 1L:length(par)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: names(tmppars) &lt;- rep("par", length(par))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: dps &lt;- Deriv::Deriv(P, tmppars)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: if (bytecompile) dps &lt;- compiler::cmpfun(dps)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: dps &lt;- compiler::cmpfun(dps)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: if (is.null(gr) &amp;&amp; derivType == "symbolic") gr &lt;- symbolicGrad_par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: gr &lt;- symbolicGrad_par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: if (bytecompile &amp;&amp; !is.null(gr)) gr &lt;- compiler::cmpfun(gr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: gr &lt;- compiler::cmpfun(gr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: if (is.null(hss) &amp;&amp; derivType.hss == "symbolic") {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dps2 &lt;- Deriv::Deriv(dps, tmppars)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (bytecompile) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dps2 &lt;- compiler::cmpfun(dps2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     hss &lt;- symbolicHessian_par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: if (bytecompile &amp;&amp; !is.null(hss)) hss &lt;- compiler::cmpfun(hss)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: P_bound &lt;- function(...) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret &lt;- P(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret &lt;- ifelse(ret &gt; 1 - 1e-32, 1 - 1e-32, ret)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret &lt;- ifelse(ret &lt; 1e-32, 1e-32, ret)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ret</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: ret &lt;- new("custom", name = name, par = par, est = est, parnames = names(par), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lbound = lbound, ubound = ubound, P = P_bound, dps = dps, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dps2 = dps2, gr = gr, hss = hss, gen = gen, userdata = NULL, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     derivType = derivType, derivType.hss = derivType.hss)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: ret@useuserdata &lt;- if (length(nms_args) == 3L) FALSE else TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> debug: ret</span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">4</span><span class="op">)</span>, <span class="st">'old2PL'</span><span class="op">)</span>, customItems<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>old2PL<span class="op">=</span><span class="va">xs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           a1     d  g  u     a      b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.1 0.989 1.856  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.2 1.081 0.808  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.3 1.703 1.803  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.4 0.766 0.486  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.5    NA    NA NA NA 0.737 -2.518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># several secondary functions supported</span></span></span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">mod</span>, calcNull<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             M2 df          p      RMSEA     RMSEA_5   RMSEA_95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats 11.93609  5 0.03567406 0.03726401 0.008942493 0.06496201</span>
<span class="r-in"><span><span class="fu"><a href="itemfit.html">itemfit</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Item.1  4.750       2      0.037  0.093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Item.2 14.441       2      0.079  0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Item.3  1.266       2      0.000  0.531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Item.4  5.241       2      0.040  0.073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Item.5  0.941       2      0.000  0.625</span>
<span class="r-in"><span><span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod</span>, full.scores<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  EAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Reliability:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4521 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Item.1 Item.2 Item.3 Item.4 Item.5     F1 SE_F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]      0      0      0      0      0 -1.870 0.693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]      0      0      0      0      1 -1.527 0.674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]      0      0      0      1      0 -1.514 0.673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]      0      0      0      1      1 -1.185 0.665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]      0      0      1      0      0 -1.096 0.665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]      0      0      1      0      1 -0.767 0.672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]      0      0      1      1      0 -0.754 0.673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]      0      0      1      1      1 -0.412 0.692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]      0      1      0      0      0 -1.372 0.668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]      0      1      0      0      1 -1.045 0.666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]      0      1      0      1      0 -1.032 0.666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]      0      1      0      1      1 -0.702 0.675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]      0      1      1      0      0 -0.610 0.680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]      0      1      1      0      1 -0.258 0.704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]      0      1      1      1      0 -0.244 0.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]      0      1      1      1      1  0.141 0.741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]      1      0      0      0      0 -1.413 0.670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]      1      0      0      0      1 -1.086 0.665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]      1      0      0      1      0 -1.073 0.665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]      1      0      0      1      1 -0.744 0.673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]      1      0      1      0      0 -0.653 0.678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]      1      0      1      0      1 -0.304 0.701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]      1      0      1      1      0 -0.290 0.702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]      1      0      1      1      1  0.090 0.736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]      1      1      0      0      0 -0.933 0.667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]      1      1      0      0      1 -0.600 0.680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]      1      1      0      1      0 -0.587 0.681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]      1      1      0      1      1 -0.233 0.706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]      1      1      1      0      0 -0.132 0.715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]      1      1      1      0      1  0.265 0.754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]      1      1      1      1      0  0.282 0.755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,]      1      1      1      1      1  0.727 0.801</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="createItem-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit the same model, but specify gradient function explicitly (use of a browser() may be helpful)</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">Theta</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="co"># browser()</span></span></span>
<span class="r-in"><span>     <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="probtrace.html">probtrace</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">PQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">P</span>, <span class="fl">1</span>, <span class="va">prod</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">r_P</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">dat</span> <span class="op">/</span> <span class="va">P</span></span></span>
<span class="r-in"><span>     <span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">grad</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">-</span><span class="va">a</span> <span class="op">*</span> <span class="va">PQ</span> <span class="op">*</span> <span class="op">(</span><span class="va">r_P</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">r_P</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">grad</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Theta</span> <span class="op">-</span> <span class="va">b</span><span class="op">)</span> <span class="op">*</span> <span class="va">PQ</span> <span class="op">*</span> <span class="op">(</span><span class="va">r_P</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">r_P</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>     <span class="co">## check with internal numerical form to be safe</span></span></span>
<span class="r-in"><span>     <span class="co"># numerical_deriv(x@par[x@est], mirt:::EML, obj=x, Theta=Theta)</span></span></span>
<span class="r-in"><span>     <span class="va">grad</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">createItem</span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">P.old2PL</span>, gr<span class="op">=</span><span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">4</span><span class="op">)</span>, <span class="st">'old2PL'</span><span class="op">)</span>, customItems<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>old2PL<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           a1     d  g  u     a      b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.1 0.989 1.856  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.2 1.081 0.808  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.3 1.703 1.803  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.4 0.766 0.486  0  1    NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.5    NA    NA NA NA 0.737 -2.518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### non-linear</span></span></span>
<span class="r-in"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">'nonlin'</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a1 <span class="op">=</span> <span class="fl">.5</span>, a2 <span class="op">=</span> <span class="fl">.1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P.nonlin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>,<span class="va">Theta</span>, <span class="va">ncat</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">a1</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">a2</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">P1</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">a1</span><span class="op">*</span><span class="va">Theta</span> <span class="op">+</span> <span class="va">a2</span><span class="op">*</span><span class="va">Theta</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">P1</span>, <span class="va">P1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu">createItem</span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">P.nonlin</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">4</span><span class="op">)</span>, <span class="st">'nonlin'</span><span class="op">)</span>, customItems<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nonlin<span class="op">=</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.984 1.854 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.087 0.809 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.705 1.803 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.762 0.486 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2     d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.806 0.065 1.818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### nominal response model (Bock 1972 version)</span></span></span>
<span class="r-in"><span><span class="va">Tnom.dev</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ncat</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">ncat</span>, <span class="va">ncat</span>, <span class="va">ncat</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="cn">T</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="cn">T</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>   <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">'nom'</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">3</span><span class="op">)</span>,gam<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P.nom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>, <span class="va">Theta</span>, <span class="va">ncat</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">alp</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">ncat</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="va">gam</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="va">ncat</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">Tnom.dev</span><span class="op">(</span><span class="va">ncat</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">alp</span></span></span>
<span class="r-in"><span>   <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu">Tnom.dev</span><span class="op">(</span><span class="va">ncat</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gam</span></span></span>
<span class="r-in"><span>   <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span>, <span class="va">ncat</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ncat</span><span class="op">)</span></span></span>
<span class="r-in"><span>       <span class="va">z</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">Theta</span> <span class="op">+</span> <span class="va">c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">P</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nom1</span> <span class="op">&lt;-</span> <span class="fu">createItem</span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">P.nom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nommod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">Science</span>, <span class="fl">1</span>, <span class="st">'nom1'</span>, customItems<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nom1<span class="op">=</span><span class="va">nom1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">nommod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Comfort</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       alp1   alp2   alp3  gam1   gam2   gam3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par -1.553 -2.015 -3.025 -3.64 -5.906 -4.533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Work</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       alp1   alp2   alp3   gam1   gam2   gam3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par -0.579 -1.262 -2.523 -1.464 -2.326 -0.326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       alp1  alp2   alp3   gam1   gam2   gam3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par -1.553 -3.79 -6.107 -3.667 -5.863 -3.949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Benefit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       alp1   alp2   alp3   gam1   gam2   gam3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par -0.808 -1.359 -2.339 -2.146 -2.913 -1.622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">Tnom.dev</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">nommod</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co">#a</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -1.64818625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.09535348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.36680800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  1.37673173</span>
<span class="r-in"><span><span class="fu">Tnom.dev</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">nommod</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="co">#d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.5197343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.1197875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  2.3864365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  1.0135103</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

